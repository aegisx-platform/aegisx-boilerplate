<!DOCTYPE html>
<html>
<head>
    <title>Storage Upload Test</title>
</head>
<body>
    <h1>Storage Upload Test</h1>
    <form id="uploadForm" enctype="multipart/form-data">
        <div>
            <label>File:</label>
            <input type="file" name="file" required>
        </div>
        <div>
            <label>Path:</label>
            <input type="text" name="path" placeholder="Optional folder path">
        </div>
        <div>
            <label>Data Classification:</label>
            <select name="dataClassification">
                <option value="internal">Internal</option>
                <option value="public">Public</option>
                <option value="confidential">Confidential</option>
                <option value="restricted">Restricted</option>
            </select>
        </div>
        <div>
            <label>Tags (JSON array):</label>
            <input type="text" name="tags" placeholder='["tag1", "tag2"]' value='[]'>
        </div>
        <div>
            <label>Custom Metadata (JSON):</label>
            <input type="text" name="customMetadata" placeholder='{"key": "value"}' value='{}'>
        </div>
        <div>
            <label>Encrypt:</label>
            <select name="encrypt">
                <option value="false">False</option>
                <option value="true">True</option>
            </select>
        </div>
        <div>
            <label>Overwrite:</label>
            <select name="overwrite">
                <option value="false">False</option>
                <option value="true">True</option>
            </select>
        </div>
        <div>
            <label>Authorization Token:</label>
            <input type="text" name="token" placeholder="Bearer token" required>
        </div>
        <div>
            <button type="submit">Upload</button>
        </div>
    </form>
    
    <div id="result"></div>

    <script>
        document.getElementById('uploadForm').addEventListener('submit', async function(e) {
            e.preventDefault();
            
            const formData = new FormData();
            const fileInput = document.querySelector('input[name="file"]');
            const token = document.querySelector('input[name="token"]').value;
            
            if (!fileInput.files[0]) {
                alert('Please select a file');
                return;
            }
            
            formData.append('file', fileInput.files[0]);
            formData.append('path', document.querySelector('input[name="path"]').value);
            formData.append('dataClassification', document.querySelector('select[name="dataClassification"]').value);
            formData.append('tags', document.querySelector('input[name="tags"]').value);
            formData.append('customMetadata', document.querySelector('input[name="customMetadata"]').value);
            formData.append('encrypt', document.querySelector('select[name="encrypt"]').value);
            formData.append('overwrite', document.querySelector('select[name="overwrite"]').value);
            
            try {
                const response = await fetch('http://localhost:3000/api/v1/storage/upload', {
                    method: 'POST',
                    headers: {
                        'Authorization': `Bearer ${token}`
                    },
                    body: formData
                });
                
                const result = await response.json();
                document.getElementById('result').innerHTML = `
                    <h3>Response (${response.status}):</h3>
                    <pre>${JSON.stringify(result, null, 2)}</pre>
                `;
            } catch (error) {
                document.getElementById('result').innerHTML = `
                    <h3>Error:</h3>
                    <pre>${error.message}</pre>
                `;
            }
        });
    </script>
</body>
</html>